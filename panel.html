
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="shortcut icon" href="fonts/favicon.ico">
    <title>Smartflower</title>
 <link rel="shortcut icon" href="fonts/faveicon.png" type="image/png">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
   <!-- Material Design for Bootstrap -->
    <link href="css/material-wfont.min.css" rel="stylesheet">
    <link href="css/ripples.min.css" rel="stylesheet">

    <!-- Dropdown.js -->
    <link href="http://cdn.rawgit.com/FezVrasta/dropdown.js/master/jquery.dropdown.css" rel="stylesheet">

  </head>
  <body>
      <!---navbar inicio---->
      

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container"> 
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span> 
            </button>
            <a target="_blank" href="index.html" class="navbar-brand">SMARTFLOWER
        </a>
        </div>
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="#">Inicio</a></li>
                 <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Administrar
                    <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Sensores <small>(no disponible)</small></a></li>
                        <li><a href="plantas.html">Plantas</a></li>
                        <li><a href="alta.html">Bases de datos de plantas</a></li>
                        <li><a href="#errore" role="button" data-toggle="modal">Reportar error y contacto</a></li>
                    </ul>
                 </li>              
             </ul>
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        <span class="glyphicon glyphicon-user"></span> 
                        <strong id="username">

                                       
                        </strong>
                        <span class="glyphicon glyphicon-chevron-down"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <div class="navbar-login">
                                <div class="row">
                                    <div class="col-lg-4">
                                        <p class="text-center">
                                            <span class="glyphicon glyphicon-user icon-size"></span>
                                        </p>
                                    </div>
                                    <div class="col-lg-12">
                                        <p>
                                            <a href="#" class="btn btn-primary btn-block">Administrar cuenta</a>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <div class="navbar-login navbar-login-session">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <p>
                                            <a href="salida.php" class="btn btn-danger btn-block">Cerrar Sesion</a>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>
      
      
<!---navbar fin--->      
      
      
    <!---contenido --->        
    
      <!---panelprimero --->
      <div class="container" style="margin-top:8%">
          
      <div class="panel panel-primary">
    <div class="panel-heading">
        <h3 class="panel-title"><strong>Estado de tus plantas </strong><small>puedes elegir otra planta en administrar</small></h3>
    </div>
    <div class="panel-body">
        <div class="list-group">
    <div class="list-group-item">
        <div class="row-picture">
            <img class="circle" src="http://media.uccdn.com/images/2/3/3/img_cuando_sembrar_los_tomates_332_orig.jpg" alt="icon">
        </div>
        <div class="row-content" id="plant_info">
            
        </div>
    </div>
            
    </div>
        <table class="table table-striped table-hover ">
    <thead>
        <tr>
            <th>#</th>
            <th>Temperatura ideal</th>
            <th>Humedad ideal</th>
            <th>Sequedad</th>
            <th>Diurno</th>
        </tr>
    </thead>
    <tbody>
        <tr class="active" id="tb_info">
            
        </tr>
    </tbody>
</table>
        <br>
   <table class="table table-striped table-hover ">
    <thead>
        <tr>
            <th>#</th>
            <th>Fecha riego</th>
            <th>Hora de riego</th>
            <th>Tiempo de riego</th>
        </tr>
    </thead>
    <tbody id="water_info">

    </tbody>
</table> 
       <div class="container">
        </div>
        <div class="container">
    <div class="row">
        <div class='col-sm-6'>
            <div class="form-group">
                <div class='input-group date' id='datetimeselect'>
                    <p><strong>Establecer fecha y hora de regado </strong><small>(YYYY/MM/DD 00:00)</small></p>
                    <input type='text' class="form-control" placeholder="2015/02/19 14:30">
                    <input type='text' class="form-control" placeholder="Tiempo de regado en minutos">
                    <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
                    </span>
                    <br>
                    <a href="#" class="btn btn-primary">Regar</a>
                </div>
            </div>
        </div>
    </div>
</div
        
</div>
    </div>  
      </div>
      <!---barras escalas --->
      <div class="container">
	<div class="row">
		<div class="col-md-3">
    <div class="jumbotron">
            <h4><strong>Humedad de la tierra </strong><small><strong id="dirtH">60%</strong></small></h4>
        
                  <div class="progress">
    <div class="progress-bar progress-bar-basic" style="width: 60%" id="dirtHp"></div>
                      
</div>
        <label href="#" class="label label-default">mas</label>
                </div>
            </div>
        
        <div class="col-md-3">
   <div class="jumbotron">
          <h4><strong>Temperatura </strong><small><strong id="temp">20Cº</strong></small></h4>
         <div class="progress">
    <div class="progress-bar progress-bar-basic" style="width: 20%" id="tempp"></div>
</div>
       <label href="#" class="label label-default">mas</label>
            </div>
            </div>
        
        <div class="col-md-3">
   <div class="jumbotron">
          <h4><strong>Luz </strong><small><strong id="brigness">80%</strong></small></h4>
                  <div class="progress">
    <div class="progress-bar progress-bar-basic" style="width: 80%" id="brignessp"></div>
</div>
       <label href="#" class="label label-default">mas</label>
            </div>
            </div>
        
        <div class="col-md-3">
   <div class="jumbotron">
            <h4><strong>Humedad </strong><small><strong id="humidity">30%</strong></small></h4>
                     <div class="progress">
    <div class="progress-bar progress-bar-basic" style="width: 30%" id="humidityp"></div>
</div>
       <label href="#" class="label label-default">mas</label>
            </div>
            </div>
	</div>
</div>
      
      
    <!---fin barras escalas ---> 
      
      
      
      <!---modals --->
      
      
       <!---Modal Contratar servicio--->
      
      
      
      <div id="errore" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Reportar Error</h4>
            </div>
            <div class="modal-body">
              <!---inicio registro body --->
                
                
                <form method="post" class="form-horizontal" action="errore.php">
    <fieldset>
         <div class="form-group">
            <div class="col-lg-10">
                <input type="user" class="form-control" id="inputasunto" placeholder="Asunto del error">
            </div>
        </div>
        <br>
        <br>
        <div class="form-group">
            <label for="textArea" class="col-lg-2 control-label">Deja una descripcion del error</label>
            <div class="col-lg-10">
                <textarea class="form-control" rows="4" id="textArea"></textarea>
                <span class="help-block">Recuerda que cuanto mas detalles nos des sobre el error mas rapido sera procesado.</span>
            </div>
       
    </fieldset>

                <!---fin registro body --->
            </div>  
              <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                <button type="submit" class="btn btn-primary">Enviar</button>
                </form>
            <div class="container"> 
            <div class="modal-footer">
              
            </div>
        </div>
    </div>
</div>
      </div>
      
      
      
      
      <!---CC license --->
      <div class="container"><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" property="dct:title" rel="dct:type">HTML SmartFlower</span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Mattia La Spina</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>
      </div>  
          <!---js code --->
      <script src="http://code.jquery.com/jquery.js"></script>
       <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
      
       <!-- Dropdown.js -->
    <script src="http://cdn.rawgit.com/FezVrasta/dropdown.js/master/jquery.dropdown.js"></script>
    <script>
      $("#dropdown-menu select").dropdown();
    </script>
        <script src="js/material.min.js"></script>
    <script src="js/ripples.min.js"></script>
    <script>
      $.material.init();
    </script>
      <script type="text/javascript">
function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    return vars;
}
          </script>
     <script type="text/javascript">
    $(document).ready(function () {
    if(getUrlVars()['plantid'] == null)
    {
      //  window.location.href = "plantas.html";
    }
        $.ajax({
            type: "GET",
            url: "islogin.php",  
            dataType: "html",
            success: function(html){ 
            console.log(html);
              if(!html=='true')  
              {  
                    window.location.href = "index.html";
              }    
            },  
 
        });  
        $.ajax({
            type: "GET",
            url: "getpaneldata.php",
            data: "plantid="+getUrlVars()['plantid'],
            dataType: "xml",
            success: function(xml) {
                $(xml).find('user-info').each(function(){
                    var name = $(this).find('name').text();
                    $("#username").append("<h4>"+name+"</h4>");
                }),
                $(xml).find('plant-info').each(function(){
                    var name = $(this).find('name').text(),
                        description = $(this).find('description').text(),
                        temp = $(this).find('temp').text(),
                        humidity = $(this).find('humidity').text(),
                        dry = $(this).find('dry').text(),
                        daytime = $(this).find('daytime').text();
                        $("#tb_info").append("<td>1</td>"
                                              +"<td>"+temp+"Cº</td>"
                                              +"<td>"+humidity+"%</td>"
                                              +"<td>"+dry+"%</td>"
                                              +"<td>"+daytime+"%</td>");
                        $('plant_info').append('<h4 class="list-group-item-heading">'+name+'</h4>'
            +'<p class="list-group-item-text">'+description+'</p><label href="#" class="label label-default">mas</label>');
                }),
                $(xml).find('water-info').each(function(){
                    var id = $(this).find('id').text(),
                        date = $(this).find('date').text(),
                        time = $(this).find('time').text(),
                        watertime = $(this).find('watertime').text();
                    $('water_info').append("<tr class='active'>"
                                                +"<td>"+id+"</td>"
                                                +"<td>"+date+"</td>"
                                                +"<td>"+time+"</td>"
                                                +"<td>"+watertime+"</td>"
                                            +"</tr>");

                });
            }
        });
        var livedata = function() {
        $.ajax({
            type: "GET",
            url: "getlivedata.php",
            data: "plantid="+getUrlVars()['plantid'], 
            dataType: "xml",
            success: function(xml) {
                    $(xml).find('livedata').each(function(){
                    var dirthumidity = $(this).find('dirthumidity').text(),
                        temp = $(this).find('temp').text(),
                        humidity = $(this).find('humidity').text(),
                        brigthness = $(this).find('brigthness').text();
                        $('dirtH').text(dirthumidity+"%");
                        $('dirtHp').css( "width", dirthumidity+"%");
                        $('temp').text(temp+"C");
                        $('tempp').css( "width", temp+"%");
                        $('brigness').text(brigthness+"%");
                        $('brignessp').css( "width", brigness+"%");     
                        $('humidity').text(humidity+"%");
                        $('humidityp').css( "width", humidity+"%");  
                });
            }
          });  
       };
       setInterval(livedata, 5000);
       livedata(); 
    });
</script>
          
  </body>
</html>
